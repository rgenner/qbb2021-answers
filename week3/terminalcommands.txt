$mkdir week3
$cd week3

Download files: 
$wget https://github.com/bxlab/qbb2021/raw/main/week3/genotypes.vcf
$wget https://github.com/bxlab/qbb2021/raw/main/week3/GS451_IC50.txt
$wget https://github.com/bxlab/qbb2021/raw/main/week3/CB1908_IC50.txt


1)	Generate genotypes.vcf using plink -pca

$plink --vcf genotypes.vcf –pca

	Files generated: 
	plink.eigenval
	plink.eigenvec < used to make PCA plot in Jupyter Notebooks

2)	Generate allele frequency spectrum using plink -freq

$plink --vcf genotypes.vcf –freq –-out freq

	Files generated: 
	plink.frq < used to make allele frequency histogram in Jupyter Notebooks

3)	Perform quantitative association testing for each phenotype

	For GS541_IC50 phenotype: 

$plink --vcf genotypes.vcf --assoc --pheno GS451_IC50.txt --covar plink.eigenvec --covar-number 1-10 --allow-no-sex

	output = plink.qassoc
	rename: 
	$mv plink.qassoc GSplink.qassoc

	For CB1908_IC50 phenotype: 

$plink --vcf genotypes.vcf --assoc –pheno CB1908_IC50.txt --covar plink.eigenvec --covar-number 1-10 --allow-no-sex

	output = plink.qassoc
	rename: 
	$mv plink.qassoc CBplink.qassoc


4)	Generate QQ and Manhattan plots for each phenotype

$pip install qmplot 
	https://github.com/ShujiaHuang/qmplot
 
Rest was done in Jupyter Notebook


5)	Make genotype ~ phenotype boxplot of top associated SNP  

	For phenotype GS541_IC50:

$plink --vcf genotypes.vcf --snp rs7257475 --recode A --out rs7257475_genotypes

	File generated: 
	Rs7257475_genotypes.raw   < used in ___________________

Rest was done in Jupyter Notebook 

